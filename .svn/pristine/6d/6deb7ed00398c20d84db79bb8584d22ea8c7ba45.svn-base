<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>商品详情</title>
    <link rel="stylesheet" href="./css/content.css" />
    <link rel="stylesheet" href="./css/xinhua.css" />
    <link rel="stylesheet" href="./css/public.css" />
</head>

<body>
    <div class="top clear">
        <div class="con">
            <div class="top-l fl">
                <span class="wel">欢迎光临新华图书网</span>
                <span class="wel-c">
                    <a href="login.html">[登录]</a>
                    <a href="login.html">[注册]</a>
                </span>
            </div>
            <div class="top-r fr">
                <span>我的账户</span>
                <span>加QQ群</span>
                <span>订单查询</span>
                <span>新华书店微博</span>
            </div>
        </div>
    </div>
    <div class="header con clear">
        <div class="logo fl"><a href="#"><img src="images/logo.jpg" /></a></div>
        <div class="header-c fl clear">
            <div class="search">
                <input type="text" class="txt fl" />
                <input type="submit" value="搜索" class="btn fl" />
                <a class="sear fl" href="#">高级搜索</a>
            </div>
        </div>
        <div class="header-r fr clear">
            <div class="box1 fl">
                <a href="#"><img src="images/ts3.jpg"><span>4000608760</span></a>
            </div>
            <div class="box2 fl">
                <a href="#"><img src="images/ts1.jpg" width="49" height="35"><span>69元免费</span></a>
            </div>
            <div class="box3 fl">
                <a href="#"><img src="images/ts2.jpg" width="49" height="35"><span>正品保障</span></a>
            </div>
        </div>
    </div>
    <div class="nav">
        <div class="con">
            <div class="nav-top clear">
                <div class="all fl">
                    <h3>所有商品分类</h3>

                </div>
                <div class="nav-c fl">
                    <ul>
                        <li class="active one"><a href="#">首页</a></li>
                        <li><a href="#">图书</a></li>
                        <li><a href="#">团购</a></li>
                        <li><a href="#">活动资讯</a></li>
                        <li><a href="#">会员俱乐部</a></li>
                        <li><a href="#">书香礼卡</a></li>
                        <li><a href="#">书籍市场</a></li>
                    </ul>
                </div>
                <div class="nav-r fr">
                    <img src="images/navto_buy1.jpg" />
                    <span>购物车：<b>0</b>件</span>
                    <img src="images/navto_buy_btn.jpg" />
                </div>
            </div>
            <div class="nav-bot">
                <ul>
                    <li class="active first">
                        <a href="#" target="_blank">图书畅销榜</a>
                        <a href="#" target="_blank">新书上架</a>
                        <a href="#" target="_blank">特价图书</a>
                        <a href="#" target="_blank">会员专供</a>
                        <a href="#" target="_blank">积分商场</a>
                    </li>
                    <li>
                        <a href="#" target="_blank">社科</a>
                        <a href="#" target="_blank">经管</a>
                        <a href="#" target="_blank">文学</a>
                        <a href="#" target="_blank">生活</a>
                        <a href="#" target="_blank">少儿</a>
                        <a href="#" target="_blank">文艺</a>
                        <a href="#" target="_blank">科技</a>
                        <a href="#" target="_blank">文教</a>
                        <a href="#" target="_blank">音乐</a>
                        <a href="#" target="_blank">辞书</a>
                        <a href="#" target="_blank">图书畅销榜</a>
                    </li>
                    <li>
                        <a href="#" target="_blank">蔡康永爱情短信:未知的恋人</a>
                        <a href="#" target="_blank">莫言文集（全新20部）</a>
                        <a href="#" target="_blank">官场笔记（1-8 ）</a>

                    </li>
                    <Li>
                        <a href="#" target="_blank">店内活动</a>
                        <a href="#" target="_blank">特价活动</a>
                        <a href="#" target="_blank">特价图书</a>
                        <a href="#" target="_blank">会员专供</a>
                        <a href="#" target="_blank">积分商场</a>
                    </Li>
                    <li>
                        <a href="#" target="_blank">官场笔记（1-8 ）</a>
                        <a href="#" target="_blank">蔡康永爱情短信:未知的恋人</a>
                        <a href="#" target="_blank">特价活动</a>
                        <a href="#" target="_blank">特价图书</a>
                    </li>
                    <li>
                        <a href="#" target="_blank">官场笔记（1-8 ）</a>
                        <a href="#" target="_blank">蔡康永爱情短信:未知的恋人</a>
                        <a href="#" target="_blank">特价活动</a>
                        <a href="#" target="_blank">特价图书</a>
                        <a href="#" target="_blank">会员专供</a>
                    </li>
                    <li>
                        <a href="#" target="_blank">官场笔记（1-8 ）</a>
                        <a href="#" target="_blank">蔡康永爱情短信:未知的恋人</a>
                        <a href="#" target="_blank">特价活动</a>
                        <a href="#" target="_blank">特价图书</a>
                        <a href="#" target="_blank">特价图书</a>
                        <a href="#" target="_blank">会员专供</a>
                    </li>
                </ul>
            </div>
        </div>
    </div>
    <div class="con main clear list1">
        <div class="aside fl">
            <h3>畅销排行榜</h3>
            <div class="hot-list">
                <ul>
                    <li>
                        <p class="clear"><em>1</em><a href="content.html" class="over">云边有个小卖部</a></p>
                        <div class="li-b clear">
                            <img src="images/112553503.jpg">
                            <div class="li-br">
                                <span>作者：杨帆</span>
                                <span>原价：￥39.00</span>
                                <span>现价：￥23.00</span>
                            </div>
                        </div>
                    </li>
                    <li>
                        <p class="clear"><em>2</em><a href="content.html" class="over">云边有个小卖部</a></p>
                        <div class="li-b clear">
                            <img src="images/4212572.jpg">
                            <div class="li-br">
                                <span>作者：杨帆</span>
                                <span>原价：￥39.00</span>
                                <span>现价：￥23.00</span>
                            </div>
                        </div>
                    </li>
                    <li>
                        <p class="clear"><em>3</em><a href="content.html" class="over">云边有个小卖部</a></p>
                        <div class="li-b clear">
                            <img src="images/4767733.jpg">
                            <div class="li-br">
                                <span>作者：杨帆</span>
                                <span>原价：￥39.00</span>
                                <span>现价：￥23.00</span>
                            </div>
                        </div>
                    </li>
                    <li>
                        <p class="clear"><em>4</em><a href="content.html" class="over">云边有个部</a></p>
                    </li>
                    <li>
                        <p class="clear"><em>5</em><a href="content.html" class="over">云小卖部</a></p>
                    </li>
                    <li>
                        <p class="clear"><em>6</em><a href="content.html" class="over">云边有卖部</a></p>
                    </li>
                    <li>
                        <p class="clear"><em>7</em><a href="content.html" class="over">个小卖部</a></p>
                    </li>
                    <li>
                        <p class="clear"><em>8</em><a href="content.html" class="over">云边有卖部</a></p>
                    </li>
                    <li>
                        <p class="clear"><em>9</em><a href="content.html" class="over">云边有部</a></p>
                    </li>
                    <li>
                        <p class="clear"><em>10</em><a href="content.html" class="over">云卖部</a></p>
                    </li>
                </ul>
            </div>
        </div>
        <div class="intro fl">
            <div class="intro-t clear">
                <div class="fl fangda">
                    <div class="photo">
                        <div class="photo-l" id="wrap">
                            <img class="ts" src="images/112553503.jpg" >
                            <div class="kong" id="box"></div>
                        </div>
                        <div class="photo-r" id="bigerea">
                        </div>
                    </div>
                    <div class="send">
                        <img src="images/ts1.jpg">
                        <img src="images/gb.jpg">
                        <img src="images/count_02.jpg">
                        <img src="images/ts3.jpg">
                        <img src="images/count_04.jpg">
                        <img src="images/gb.jpg">
                    </div>
                </div>
                <div class="detail fl">
                    <div class="name d1">等我出门不能让女人</div>
                    <div class="vipprice d1">现价：<span>20.22</span>元</div>
                    <div class="price d1">定价：￥<span>20.22</span></div>
                    <div class="zhe d1"><span>折扣：<b>2.55</b>折</span><em>节省：￥<b>2.22</b>元</em></div>
                    <div class="stock d1">库存：212222</div>
                    <div class="line" id="line"></div>
                    <div class="writer">
                        <div class="wname d1"><span>作者：杨帆</span><em>出生日期：2012/2/2</em></div>
                        <div class="chu d1"><span>出版社：三位数</span><em>页数：</em></div>
                        <div class="isbn d1"><span>ISBN：212345432</span><em>装帧：</em></div>
                        <div class="kai d1"><span>开本：16开</span><em>字数：</em></div>
                    </div>
                    <div class="mai">
                        <div class="mai-t">
                            我要买：
                            <input type="image" src="images/count_04.jpg" class="tu up" name="up" >
                            <input type="text" value="${this.goods[j].num}" class="txt">
                            <input type="image" src="images/count_02.jpg" class="tu down" name="down">    
                            件
                        </div>
                        <div class="mai-b clear">
                            <a href="shopcar.html" class="m1">立即购买</a>
                            <a href="#" class="m2">&nbsp;&nbsp;&nbsp;&nbsp;加入收藏夹</a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="intro-b">
                <div class="intro-b1">相关信息</div>
                <div class="intro-b2">您想发表评论请先
                    <a href="login.html">登录</a> 或
                    <a href="register.html">注册</a>
                </div>
            </div>
        </div>
    </div>
    <div class="footer con clear">
        <div class="footer_logo fl"><img src="images/ft_1.jpg" width="268" height="32"><br>
            <img src="images/ft2.jpg" width="252" height="58"></div>
        <div class="footer_gn clear fl">
            <div class="howpay_box">
                <h3><img src="images/f2.jpg" width="25" height="25"><span>新手入门</span></h3>
                <ul>
                    <li><a href="#" target="_blank"><span class="style3">购物保障</span></a></li>
                    <li><a href="#" target="_blank"><span class="style3">购物流程</span></a></li>
                    <li><a href="#" target="_blank"><span class="style3">会员制度</span></a></li>
                    <li><a href="#" target="_blank"><span class="style3">常见问题</span></a></li>
                    <li><a href="#" target="_blank"><span class="style3">联系客服</span></a></li>
                </ul>
            </div>
            <div class="howpay_box">
                <h3><img src="images/f3.jpg" width="25" height="25"><span>特色服务</span></h3>
                <ul>
                    <li><a href="#" target="_blank"><span class="style3">书香礼品卡</span></a></li>
                    <li><a href="#" target="_blank"><span class="style3">其它服务</span></a></li>
                    <li><a href="#" target="_blank"><span class="style3">团购优惠</span></a></li>
                </ul>
            </div>
            <div class="howpay_box">
                <h3><img src="images/f4.jpg" width="25" height="25"><span>支付方式</span></h3>
                <ul>
                    <li><a href="#" target="_blank"><span class="style3">货到付款</span></a>
                    </li>
                    <li><a href="#" target="_blank"><span class="style3">在线支付</span></a>
                    </li>
                    <li><a href="#" target="_blank"><span class="style3">邮局汇款</span></a>
                    </li>
                    <li><a href="#" target="_blank"><span class="style3">银行转帐/汇款</span></a></li>
                    <li><a href="#" target="_blank"><span class="style3">公司转账</span></a>
                    </li>

                </ul>
            </div>
            <div class="howpay_box">
                <h3><img src="images/f5.jpg" width="25" height="25"><span>配送服务</span></h3>
                <ul>
                    <li><a href="#" target="_blank"><span class="style3">配送方式</span></a>
                    </li>
                    <li><a href="#" target="_blank"><span class="style3">收费标准</span></a>
                    </li>
                    <li><a href="#" target="_blank"><span class="style3">快递查询入口</span></a></li>
                    <li><a href="#" target="_new"><span class="style3">验货与签收</span></a>
                    </li>
                </ul>
            </div>
            <div class="howpay_box">
                <h3><img src="images/f6.jpg" width="25" height="25"><span>售后服务</span></h3>
                <ul>
                    <li><a href="#" target="_blank"><span class="style3">退换货规则</span></a>
                    </li>
                    <li><a href="#" target="_blank"><span class="style3">退换货流程</span></a>
                    </li>
                    <li><a href="#" target="_blank"><span class="style3">退换货方式说明</span></a></li>
                </ul>
            </div>
            <div class="howpay_box">
                <h3><img src="images/f1.jpg" width="25" height="25"><span>帮助中心</span></h3>
                <ul>
                    <li><a href="#" target="_blank"><span class="style3">我的订单</span></a></li>
                    <li><a href="#" target="_blank"><span class="style3">常见问题</span></a></li>
                    <li><a href="#" target="_blank"><span class="style3">找回密码</span></a></li>
                    <li><a href="#" target="_blank"><span class="style3">关于我们</span></a></li>
                </ul>
            </div>
            <div class="clear"></div>
        </div>
        <div class="clear"></div>
    </div>
    <div class="con fot">
        <br>
        战略合作伙伴：
        <a href="#" target="_blank">
            <img src="images/eye_logo.jpg">
        </a>
        <a href="#" target="_blank">
            <img src="images/bookaskLOGO.jpg" height="26" style="vertical-align:middle;">
        </a>
        <br>
        地址：沈阳市和平区中山路70号 新华大厦1607室&nbsp;&nbsp; 邮编:110001 &nbsp;&nbsp;客服:400-060-8760
        <br>
        增值电信业务经营许可证:辽B2-20130065
        <br>
        辽ICP备09000237号-6 辽ICP备09000237号-1
        <br>
        <a href="#"><img border="0" dragover="true" src="images/footaq_logo.png"></a>
    </div>

</body>
<script src="js/jquery.js"></script>
<script src="js/nav.js"></script>
<script src="js/ajax.js"></script>
<script src="js/cookie.js"></script>
<script>
    class Car {
        constructor(options) {
            this.url = options.url;
            this.intro = options.intro;
            this.load();
            this.addEvent();
        }
        load() {
            var that = this;
            ajaxGet(this.url, function (res) {
                that.res = JSON.parse(res);
                // console.log(that.res);
                that.getCookie();
            })
        }
        getCookie() {
            // this.goodss = getCookie("goodss") ? JSON.parse(getCookie("goodss")) : [];
            this.goodss = getCookie("goodss") ? JSON.parse(getCookie("goodss")) : [];
            this.display();
        }
        display() {
            var str = "";
            var str1 = "";
            for (var i = 0; i < this.res.length; i++) {
                if (this.res[i].goodsId === this.goodss[0].index) {
                    console.log(this.goodss[0].index);
                    console.log(1);
                    str = `<div class="fl fangda">
                    <div class="photo">
                        <div class="photo-l" id="wrap">
                            <img class="ts" src="images/112553503.jpg" >
                            <div class="kong" id="box"></div>
                        </div>
                        <div class="photo-r" id="bigerea">
                        </div>
                    </div>
                    <div class="send">
                        <img src="images/ts1.jpg">
                        <img src="images/gb.jpg">
                        <img src="images/count_02.jpg">
                        <img src="images/ts3.jpg">
                        <img src="images/count_04.jpg">
                        <img src="images/gb.jpg">
                    </div>
                </div>
                <div class="detail fl">
                    <div class="name d1">等我出门不能让女人</div>
                    <div class="vipprice d1">现价：<span>20.22</span>元</div>
                    <div class="price d1">定价：￥<span>20.22</span></div>
                    <div class="zhe d1"><span>折扣：<b>2.55</b>折</span><em>节省：￥<b>2.22</b>元</em></div>
                    <div class="stock d1">库存：212222</div>
                    <div class="line" id="line"></div>
                    <div class="writer">
                        <div class="wname d1"><span>作者：杨帆</span><em>出生日期：2012/2/2</em></div>
                        <div class="chu d1"><span>出版社：三位数</span><em>页数：</em></div>
                        <div class="isbn d1"><span>ISBN：212345432</span><em>装帧：</em></div>
                        <div class="kai d1"><span>开本：16开</span><em>字数：</em></div>
                    </div>
                    <div class="mai">
                        <div class="mai-t">
                            我要买：
                            <input type="image" src="images/count_04.jpg" class="tu up" name="up" >
                            <input type="text" value="" class="txt">
                            <input type="image" src="images/count_02.jpg" class="tu down" name="down">    
                            件
                        </div>
                        <div class="mai-b clear">
                            <a href="shopcar.html" class="m1">立即购买</a>
                            <a href="#" class="m2">&nbsp;&nbsp;&nbsp;&nbsp;加入收藏夹</a>
                        </div>
                    </div>
                </div>
                    `;
                }
            }
            this.intro.innerHTML = str;
            this.fa();
        }
        fa() {
            var wrap = document.getElementById("wrap");
            var box = document.querySelector("#box");
            var bigArea = document.getElementById("bigerea");
            wrap.onmouseenter = function () {
                box.style.display = "block";
                bigArea.style.display = "block";
                // var r = box.clientWidth / bigArea.clientWidth;
                var r = (wrap.clientWidth - box.clientWidth) / (450 - bigArea.clientWidth);
                // 绑定mousemove事件
                document.onmousemove = function (e) {
                    // 计算鼠标在页面中的距离
                    var mouseX = e.pageX;
                    var mouseY = e.pageY;
                    // 计算元素在视口中的距离
                    var elementX = offset(wrap).left;
                    var elementY = offset(wrap).top;
                    // 计算鼠标在元素中的距离
                    var resultX = mouseX - elementX - wrap.clientLeft - box.clientWidth / 2;
                    var resultY = mouseY - elementY - wrap.clientTop - box.clientHeight / 2;
                    if (resultX < 0) {
                        resultX = 0;
                    } else if (resultX > wrap.clientWidth - box.clientWidth) {
                        resultX = wrap.clientWidth - box.clientWidth;
                    }

                    if (resultY < 0) {
                        resultY = 0;
                    } else if (resultY > wrap.clientHeight - box.clientHeight) {
                        resultY = wrap.clientHeight - box.clientHeight;
                    }
                    box.style.left = resultX + "px";
                    box.style.top = resultY + "px";
                    bigArea.style.backgroundPositionX = -resultX / r + "px";
                    bigArea.style.backgroundPositionY = -resultY / r + "px";

                }
            }
            wrap.onmouseleave = function () {
                box.style.display = "none";
                bigArea.style.display = "none";
            }
            function offset(dom) {
                // 返回一个对象
                var obj = {
                    left: 0,
                    top: 0
                }

                // 先让这个对象加上 dom的自己得到定位父元素的距离
                obj.left = dom.offsetLeft;
                obj.top = dom.offsetTop;
                // 判定浏览器是否是IE8 
                var isIE8 = window.navigator.userAgent.indexOf("MSIE 8") != -1;


                // 循环往上走 累加每一个offsetParent的offsetLeft和clientLeft 
                // 加每一个offsetParent的offsetTop和clientTop
                var offsetParent = dom.offsetParent;
                while (offsetParent != document.body) {
                    if (isIE8) {
                        obj.left += offsetParent.offsetLeft;
                        obj.top += offsetParent.offsetTop;
                    } else {
                        obj.left += offsetParent.offsetLeft + offsetParent.clientLeft;
                        obj.top += offsetParent.offsetTop + offsetParent.clientTop;
                    }
                    offsetParent = offsetParent.offsetParent;
                }
                return obj;
            }
        }
        addEvent() {
            // var that = this;
            // this.tbody.addEventListener("click", function (eve) {
            //     if (eve.target.className == "tu up"){     
            //         that.id = eve.target.parentNode.parentNode.getAttribute("index");
            //         eve.target.nextElementSibling.value=+eve.target.nextElementSibling.value+1;
            //         that.value=eve.target.nextElementSibling.value;
            //         that.updateCookie(function (i) {
            //             that.goods[i].num=that.value;
            //             that.display();
            //         });
            //     }
            //     if (eve.target.className == "tu down"){     
            //         that.id = eve.target.parentNode.parentNode.getAttribute("index");
            //         eve.target.previousElementSibling.value=+eve.target.previousElementSibling.value-1;

            //         that.value=eve.target.previousElementSibling.value;
            //         that.updateCookie(function (i) {
            //             that.goods[i].num=that.value;
            //             that.display();
            //         });
            //     }
            // });

        }
        // updateCookie(cb){
        //     for (var i = 0; i < this.goods.length; i++) {
        //         if (this.goods[i].id === this.id) {
        //             cb(i);
        //         }
        //     }
        //     setCookie("goods",JSON.stringify(this.goods));
        // }
    }

    new Car({
        url: "http://localhost/xinhua/shop.json",
        intro: document.querySelector(".intro-t")
    })



</script>
<!-- <script src="js/fangda.js"></script> -->

</html>